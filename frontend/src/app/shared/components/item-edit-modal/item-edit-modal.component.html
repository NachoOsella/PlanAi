<app-modal
  [title]="getTitle()"
  [showDelete]="data?.mode === 'edit'"
  (close)="onClose()"
  (save)="onSave()"
  (delete)="onDelete()"
>
  <div class="space-y-5">
    <!-- Title Field (all types) -->
    <div class="space-y-2">
      <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 uppercase tracking-wider">
        Title
      </label>
      <input
        #titleInput
        type="text"
        [(ngModel)]="formData['title']"
        (keydown.enter)="onSave()"
        class="w-full h-12 bg-slate-50 dark:bg-slate-900 border-none rounded-xl px-4 ring-1 ring-slate-200 dark:ring-slate-700 focus:ring-2 focus:ring-primary transition-all text-sm font-medium dark:text-white"
        placeholder="Enter title..."
      />
    </div>

    <!-- Description Field (epic & task) -->
    @if (data?.type === 'epic' || data?.type === 'task') {
      <div class="space-y-2">
        <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 uppercase tracking-wider">
          Description
        </label>
        <textarea
          [(ngModel)]="formData['description']"
          rows="3"
          class="w-full bg-slate-50 dark:bg-slate-900 border-none rounded-xl px-4 py-3 ring-1 ring-slate-200 dark:ring-slate-700 focus:ring-2 focus:ring-primary transition-all text-sm font-medium dark:text-white resize-none"
          placeholder="Enter description..."
        ></textarea>
      </div>
    }

    <!-- User Story specific fields -->
    @if (data?.type === 'story') {
      <div class="space-y-2">
        <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 uppercase tracking-wider">
          As a...
        </label>
        <input
          type="text"
          [(ngModel)]="formData['asA']"
          class="w-full h-12 bg-slate-50 dark:bg-slate-900 border-none rounded-xl px-4 ring-1 ring-slate-200 dark:ring-slate-700 focus:ring-2 focus:ring-primary transition-all text-sm font-medium dark:text-white"
          placeholder="e.g., registered user"
        />
      </div>
      <div class="space-y-2">
        <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 uppercase tracking-wider">
          I want to...
        </label>
        <input
          type="text"
          [(ngModel)]="formData['iWant']"
          class="w-full h-12 bg-slate-50 dark:bg-slate-900 border-none rounded-xl px-4 ring-1 ring-slate-200 dark:ring-slate-700 focus:ring-2 focus:ring-primary transition-all text-sm font-medium dark:text-white"
          placeholder="e.g., reset my password"
        />
      </div>
      <div class="space-y-2">
        <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 uppercase tracking-wider">
          So that...
        </label>
        <input
          type="text"
          [(ngModel)]="formData['soThat']"
          class="w-full h-12 bg-slate-50 dark:bg-slate-900 border-none rounded-xl px-4 ring-1 ring-slate-200 dark:ring-slate-700 focus:ring-2 focus:ring-primary transition-all text-sm font-medium dark:text-white"
          placeholder="e.g., I can regain access to my account"
        />
      </div>
    }

    <!-- Priority (epic & story) -->
    @if (data?.type === 'epic' || data?.type === 'story') {
      <div class="space-y-2">
        <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 uppercase tracking-wider">
          Priority
        </label>
        <div class="flex gap-2">
          @for (p of priorities; track p) {
            <button
              type="button"
              (click)="formData['priority'] = p"
              class="flex-1 h-10 rounded-xl text-xs font-bold uppercase transition-all"
              [class.bg-red-100.text-red-600.ring-2.ring-red-500]="p === 'HIGH' && formData['priority'] === p"
              [class.bg-yellow-100.text-yellow-600.ring-2.ring-yellow-500]="p === 'MEDIUM' && formData['priority'] === p"
              [class.bg-green-100.text-green-600.ring-2.ring-green-500]="p === 'LOW' && formData['priority'] === p"
              [class.bg-slate-100.text-slate-500.dark:bg-slate-800.dark:text-slate-400]="formData['priority'] !== p"
            >
              {{ p }}
            </button>
          }
        </div>
      </div>
    }

    <!-- Estimated Hours (task only) -->
    @if (data?.type === 'task') {
      <div class="space-y-2">
        <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 uppercase tracking-wider">
          Estimated Hours
        </label>
        <input
          type="number"
          [(ngModel)]="formData['estimatedHours']"
          min="0"
          step="0.5"
          class="w-full h-12 bg-slate-50 dark:bg-slate-900 border-none rounded-xl px-4 ring-1 ring-slate-200 dark:ring-slate-700 focus:ring-2 focus:ring-primary transition-all text-sm font-medium dark:text-white"
          placeholder="e.g., 4"
        />
      </div>
    }
  </div>
</app-modal>
